# js-smart-informer

### Разработка 
Был создан класс (SmartInformerCreator), определяющий нужное место для отображения блока информера. 
Класс принимает три параметра:

- id - идентификатор компонента(например 141665)
- процент от
- процент до    
    
Два параметра - процента, определяют тот диапазон, в который должна быть вставлена статья.
Созданный класс создает диапазон(в пикселях) согласно параметрам от(%) и до(%). В данном диапазоне производится поиск нод, между которыми будет вставлен блок информера. 
Логика информера соответствует Milestone-у.

### Важно
По умолчанию, в разных браузерах могут быть различными величины высоты body(различны в webkit и gecko). Это нужно учитывать, т.к. это может влиять на положение информера на странице.

Для определения сложных embedded объектов был создан файл - заготовка(src/embedded.js). Это словарь сервисов, которыми пользуются пользователи при наполнении статьи информацией(добавление youtube, twitter, и др.). Данный словарь может быть использован(и расширен) в качестве основы для определения того, является ли элемент DOM одним из embedded объектов. На текущий момент он не интегрирован в скрипт, т.к. основные сервисы используют тег iframe - информер будет вставлен за ним. При необходимости может быть интегрирован в скрипт.    

Если статья короткая (мене 300px) - то блок не будет отображен. При этом в консоль будет выведено сообщение(warning): Smart Informer: Article is too small to render informer block   

### Тестирование
При создании скрипта была использована библиотека [Readability.js](https://github.com/mozilla/readability) для определения местонахождения статьи на WEB странице. В состав бибилиотеки входит набор тестовых страниц для нужд тестирования библиотеки. Данный набор набор включает в себя 71 WEB статей из различных источников. Этот набор был использован для тестирования нашего скрипта. 

Тесты находятся в каталоге test_pages. Внутри название каждого каталога - название сайта. Тест нашего информера - smart_informer_test.html.   

### Важно!!! 
Если вы измените файлы dist/pas-test.com.141665.js или dist/glued.informer.js и при этом захотите увидеть результат изменений на тестовых страницах, то необходимо перейдите в каталог test_pages(test_pages_prod) и выполнить команду: 
```
node prepare.js 
```
Данная комманда возьмёт test_pages/template.html и положит туда файл содержимое test_pages/[имя веб сайта]/expected.html (это непосредственный контент, который должена вернуть библиотека [Readability.js](https://github.com/mozilla/readability)). После этого все будет сохранено в test_pages(test_pages_prod)/[имя веб сайта]/smart_informer_test.html, где непосредственно и нужно смотреть результат.   
При тестировании нужно настроить пути в файле test_pages(test_pages_prod)/template.html и dist/pas-test.com.141665.js (метод start).
